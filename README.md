# ArchiveMaps 
#### 「座標も画像も、地球をメモ帳へ」、同期可能高機能メモアプリです。

## 目次
- [ダウンロード](#ダウンロード)
- [アプリの主機能](#アプリ主機能)
- [技術スタック](#技術スタック)
- [アピールポイント](#アピールポイント)

## ダウンロード
DeployGateから配布しております  
https://dply.me/tex2rn

## アプリ主機能
* GoogleMap上へマーカーを設置
  * マーカー一つ一つにはメモや画像、動画などを保存可能      


  
* 表示
  * Google Maps APIを使用した地図表示
  * 現在位置の表示
  * 作成したマーカーの一覧表示
  * 視覚的に理解しやすいアイコンを用いたボタン表示
  * Nominatim APIを用いたマーカーの住所表示    


* データ
  * 設置したマーカー情報をSQLデータベースで保存（アカウント同期が必要）
  * SQLデータベースにはそれぞれ「マーカー名」「メモ」「設置日時」「座標」「マーカーカラー」を保存
  * アカウントを用いないゲストモードでもローカルストレージ保存を用いて利用可能
 
* 検索機能
  * フィルタリング機能搭載
  * フィルタリング機能は主に「マーカー名」「メモ内容（完全一致検索）」「設置日時」で構成
  * Embeddings APIを用いたメモ内容の意味検索（アカウント同期が必要）



* アカウント同期
  * Supabase Authを使用した認証機能
  * メールアドレスとパスワードによるログイン
  * アカウント連携により別の端末でもメモを自由に管理
  * SQLデータベースに保存されたメモ内容から意味検索が可能

* オンボーディング機能
    * アプリ開始時、各操作スクリーンにオンボーディングを用いた視覚的にわかりやすい操作説明


## 技術スタック
* Jetpack ライブラリ
  * Navigation
  * ViewModel
  * DataStore
 
* 権限
  * Accompanist

* 依存性注入
  * Dagger Hilt

* 非同期処理
  * Kotlin Coroutines

* 通信
  * Moshi
  * Retrofit2
  * Okhttp3

### 連携API
 * [Maps SDK for Android](https://developers.google.com/maps/documentation/android-sdk/overview?hl=ja)  
   地図を表示する際に使用
 * [Nominatim](https://nominatim.org/)  
   マーカー情報の住所表示に使用
 * [Supabase](https://supabase.com/docs/guides/api)  
   Authを用いたアカウント認証やデータベースへマーカー情報の保存をする際に使用  
 * [Vector embeddings](https://platform.openai.com/docs/guides/embeddings)  
   検索ワードと保存されたメモ内容をベクトル化し、ユークリッド距離を計算するために使用。


# アピールポイント
 ## クリーンアーキテクチャを意識した構造設計とMVVMの導入
 本アプリケーションでは、機能の追加・変更がしやすく、テストが容易で、長期的に保守・拡張が可能な構造を実現することを目指しました。  
 
  ### 初期設計  
   開発の初期段階においては、UI層に直接ロジックや状態管理を集中させており、また各ロジックがインフラ（DBやAPI）にそのまま依存いたため、再利用性やテストのしにくさにつながっていました。加えて各クラスは相互に依存し合っていたため、少しの変更でも影響範囲が広がりやすくなっていました。  

### 責務分離と、依存関係の制御  
これらの問題を解決するために、本アプリではクリーンアーキテクチャとMVVMの構造を導入しました。  
* クリーンアーキテクチャの採用  
    * アプリケーションをドメイン層・データ層・UI層に分割することで、ビジネスロジックをドメイン層に集中させ、関心を分離し、依存性を逆転。  
    * リポジトリパターンを用いてデータアクセスを抽象化することで、データ層の実装に依存しない構造を構築。  
    * 依存関係の方向性を内向き（ビジネスロジック → インターフェース → 実装）に統一することで、柔軟性と再利用性を確保。  
* MVVMの導入  
    * ViewModelを通じてUIの状態管理やロジックを分離し、UIコンポーネントは状態の表示に専念できるように。  

これにより、テストのしやすさ、変更時の影響範囲の最小化、及び再利用可能なコンポーネント設計など、開発・保守において重要な要件を満たす構造が実現できました。  

## マーカーのクラウド保存  
本アプリケーションは、ユーザーごとのマーカー情報をクラウドデータベースに保存しているため、もし端末の故障や紛失といったトラブルが発生した場合でも、同じアカウントでログインすることで、保存されたマーカーを引き続き表示・編集することが可能です。

### ニーズに合わせたモード  
一方で、「アカウント認証に抵抗がある」「まずは試してみたい」といったユーザーに向けて、ゲストモードも提供しています。


### アカウント認証による主な利点とゲストモードの詳細
* SupabaseAuthによるアカウント認証  
     * マーカーデータをSupabaseにて保存しているため、端末に障害が発生した場合でもマーカー情報を失いません。 
     * 同一のアカウントを複数人で共有することで、複数人によるマーカーの共同編集も実現できます。たとえば、チームでのフィールドワークやプロジェクト共有に活用可能。  
     * アカウントセッションは端末に保存されており、一度ログインすれば次回以降の再ログインは非常に簡単です。  
       
 * ゲストモードの提供とローカルストレージの活用  
     * ゲストモードでは、マーカー情報は端末のローカルストレージに保存。  
     * 一部の機能に制限されますが、マーカーの設置・編集・読み込みといった基本的な操作はアカウント登録なしで利用可能。
  
これにより、ユーザーの選択肢を広げつつ、データの保存性と利便性を両立する設計を実現しています。


## AIを用いた意味検索
本アプリケーションではマーカーを検索する際に、マーカーのメモ内容を通常の完全一致検索に加えて意味検索（ニュアンス検索）することも可能です。

### 溢れるメモ内容
メモアプリは時間と共に保存されるメモ内容が増えていきます。そうなった場合、検索したいメモの内容を鮮明に思い出せない時が発生します。

### Embeddings APIを用いたベクトル化
そのような問題に対処するため本アプリではOpenAIのEmbeddings APIを用いた意味検索をフィルタリング機能として搭載しています。  

　　1　Supabaseに保存されるマーカーのメモを全てベクトル化。  
　　2　検索する際は、検索ワードをベクトル化。  
　　3　Supabase Postgres functionを呼び出し、各メモのベクトルと検索ワードのベクトルのユークリッド距離を求める。  
　　4　距離が近しいメモを選定しアプリ内部で検索結果として表示。  


## アクセシビリティ
本アプリでは、すべてのユーザーが直感的かつ快適に利用できるよう、アクセシビリティへの配慮を取り入れた設計を行っています。

### 全ての人が平等に扱える仕組み
* オンボーディング機能の実装  
   * 初回起動時には、主要な操作や機能の使い方をガイドするオンボーディングを表示し、ユーザーが迷わずアプリを使い始められるように設計。  
* ローディングアニメーションの導入  
   * 処理中の状態を視覚的に伝えることで、ユーザーの安心感と操作性を向上。  
* 色覚対応を意識した配色設計  
   * ボタンや強調要素には明確なコントラスト比を持つ配色を使用し、色覚異常を持つ方にも配慮。  
* フォントサイズ変更への対応  
   * UI要素のレイアウトには柔軟性を持たせ、ユーザーの端末設定によるフォントサイズの変更にも崩れず対応。  
* 多言語対応の仕組み  
   * 表示されるすべてのテキストはリソースファイルを通して管理されており、日本語以外への翻訳・切り替えが容易な設計としています。    

これらの工夫により、年齢・言語・視覚特性にかかわらず、誰もが快適にアプリを操作できる体験を実現しました。  
   
   









